# MarkItDown.GUI

シンプルなドラッグ&ドロップ操作で、様々なファイル形式をMarkdown形式に変換するWindowsアプリケーションです。

## 特徴

- **簡単操作**: ファイルやフォルダをウィンドウにドロップするだけで自動変換
- **多様なファイル形式に対応**: Office文書、画像、音声、テキストファイルなど幅広く対応
- **自動環境構築**: Python環境やFFmpegを自動でダウンロード・セットアップ
- **Ollama連携**: ローカルLLM (Ollama) を使用した画像説明生成に対応
- **モダンなUI**: Avalonia UIを使用した軽量で使いやすいインターフェース

## ダウンロード

最新版は以下のGitHub Releasesページからダウンロードできます。

**[📥 ダウンロードページ（GitHub Releases）](https://github.com/1llum1n4t1s/MarkItDown.GUI/releases)**

`Setup.exe` をダウンロードして実行してください。

## サポートしているファイル形式

### テキスト・文書ファイル
- `.txt`, `.md`, `.html`, `.htm`, `.csv`, `.json`, `.xml`

### Office文書
- `.docx`, `.doc`, `.xlsx`, `.xls`, `.pptx`, `.ppt`

### 画像ファイル
- `.jpg`, `.jpeg`, `.png`, `.gif`, `.bmp`, `.tiff`, `.tif`

### 音声ファイル
- `.mp3`, `.wav`, `.flac`, `.aac`, `.ogg`

### アーカイブファイル
- `.zip`, `.rar`, `.7z`, `.tar`, `.gz`

## 使い方

1. アプリケーションを起動します
2. 変換したいファイルまたはフォルダをウィンドウにドラッグ&ドロップします
3. 自動的に変換が開始され、元のファイルと同じ場所にMarkdownファイル（`.md`）が生成されます

変換されたファイルは `ファイル名_タイムスタンプ.md` という形式で保存されます。

## Ollama連携機能（自動セットアップ）

画像ファイルの説明を自動生成するために、Ollamaを使用できます。

### 自動セットアップ

**初回起動時に自動的に実行されます：**

1. **Ollamaの自動ダウンロード**
   - アプリケーション起動時、Ollamaが組み込まれていない場合は自動的にダウンロードされます
   - GitHubから最新版のOllama for Windowsを取得します
   - ダウンロード先: `lib/ollama/` フォルダ

2. **Ollamaサーバーの自動起動**
   - ダウンロード完了後、バックグラウンドでOllamaサーバーを起動します
   - `http://localhost:11434` で待機します

3. **ビジョンモデルの自動ダウンロード**
   - `llava` モデルが存在しない場合、自動的にダウンロードを開始します
   - 初回は数GB（モデルサイズ）のダウンロードが発生します
   - ダウンロード中もログに進捗が表示されます

4. **完了**
   - ログに「Ollamaが利用可能です」と表示されれば準備完了です
   - 画像ファイルをドロップすると、自動的に説明が生成されます

### 手動セットアップ（オプション）

自動セットアップを使用せずに、手動でOllamaをインストールすることもできます：

1. [Ollama公式サイト](https://ollama.com/)からダウンロードしてインストール
2. コマンドで `ollama pull llava` を実行
3. アプリケーションが自動的に検出します

### 設定のカスタマイズ

設定ファイル `appsettings.xml` で以下をカスタマイズできます：

```xml
<AppSettings>
  <OllamaUrl>http://localhost:11434</OllamaUrl>
  <OllamaModel>llava:34b</OllamaModel>
  <OllamaGpuDevice>0</OllamaGpuDevice>
</AppSettings>
```

#### GPU設定（OllamaGpuDevice）

使用するGPUを指定できます：

- **未設定または`0`** (デフォルト): Ollamaが自動でGPUを検出して使用（推奨）
- **`1`**: GPU 1のみを使用
- **`0,1`**: GPU 0と1の両方を使用
- **`-1`**: CPUのみ使用（GPUを使用しない）

`CUDA_VISIBLE_DEVICES`を設定すると環境によってはGPUが検出されない場合があるため、デフォルトでは未設定（自動検出）にしています。複数GPUで特定のGPUを使いたい場合のみ設定してください。

**GPU IDの確認方法:**
コマンドプロンプトで `nvidia-smi -L` を実行すると、利用可能なGPUのリストが表示されます。

### 使用可能なモデル

- `llava`: 汎用的な画像理解モデル（推奨）
- `llava:13b`: より高精度な大型モデル
- `llava:34b`: 最高精度の大型モデル（高性能PC推奨）

### 注意事項

- **初回起動時の所要時間**: Ollamaとllavaモデルのダウンロードに10～30分程度かかる場合があります（ネットワーク速度に依存）
- **ディスク容量**: Ollama本体（約200MB）+ llavaモデル（約4.5GB）が必要です
- **メモリ要件**: モデル実行時に8GB以上のRAMを推奨します
- Ollamaのダウンロードに失敗した場合でも、画像ファイルの基本情報（ファイル名、サイズなど）は出力されます
- 画像説明の生成には数秒～数十秒かかる場合があります

## 動作環境

- Windows 11 (ビルド 26200以降)
- .NET 10.0 Runtime（インストーラーに含まれています）

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。詳細は [LICENSE](LICENSE) ファイルをご覧ください。
